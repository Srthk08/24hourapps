---
import Layout from '../layouts/Layout.astro';
import AuthGuard from '../components/AuthGuard.astro';
---

<Layout title="Dashboard - DevExpress">
  <AuthGuard>
    <section class="py-12 bg-gray-50 min-h-screen">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Welcome Header -->
        <div class="mb-8">
          <h1 class="text-3xl font-bold text-gray-900 mb-2">
            Welcome back, <span id="user-welcome">User</span>!
          </h1>
          <p class="text-gray-600">Browse products, manage your orders, and customize your projects.</p>
        </div>

        <!-- Recent Activity -->
        <div id="recent-activity" class="bg-white rounded-lg shadow-sm p-6">
          <h2 class="text-2xl font-bold text-gray-900 mb-4">Recent Activity</h2>
          <div id="activity-content">
            <div class="text-center py-6">
              <p class="text-gray-800 text-base font-medium">Get started with your first order</p>
              <p class="text-gray-500 text-sm mt-1">Choose a product, submit your requirements, and track it in My Orders.</p>
              <div class="mt-4 flex items-center justify-center gap-3">
                <a href="/products" class="inline-flex items-center px-5 py-2.5 rounded-md bg-primary-600 text-white hover:bg-primary-700 transition-colors">Browse Products</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </AuthGuard>
</Layout>

<script>
  // Update welcome message with user name
  document.addEventListener('DOMContentLoaded', () => {
    try {
      const sessionData = sessionStorage.getItem('simple-auth-session');
      if (sessionData) {
        const session = JSON.parse(sessionData);
        if (session.user) {
          const userName = session.user.full_name || session.user.email?.split('@')[0] || 'User';
          const welcomeElement = document.getElementById('user-welcome');
          if (welcomeElement) {
            welcomeElement.textContent = userName;
          }
        }
      }
    } catch (error) {
      console.error('Error loading user data:', error);
    }
  });
</script>

